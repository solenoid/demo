import Link from 'next/link'

const REAL_INPUT = `#.###########################################################################################################################################
#.#...#...###.....#...###...#...#.......#.....#.............#.........###...............#.......#.....#.....#.....#.......#...#.....###.....#
#.#.#.#.#.###.###.#.#.###.#.#.#.#.#####.#.###.#.###########.#.#######.###.#############.#.#####.#.###.#.###.#.###.#.#####.#.#.#.###.###.###.#
#...#.#.#.....#...#.#.....#.#.#.#.....#.#...#.#.......#.....#.#.......#...#.............#.....#.#...#...#...#.#...#.....#.#.#.#...#...#.#...#
#####.#.#######v###.#######.#.#.#####.#.###.#.#######.#.#####.#.#######.###.#################.#.###.#####.###.#.#######.#.#.#.###.###.#.#.###
#.....#...#...#.>.#.......#.#.#.#####.#...#.#.#...#...#.#.>.>.#...#...#.#...#.........#.......#.###...#...###.#.#.......#.#.#...#...#.#.#.###
#.#######.#.#.#v#.#######.#.#.#.#####.###.#.#.#.#.#.###.#.#v#####.#.#.#.#.###.#######.#.#######.#####.#.#####.#.#.#######.#.###.###.#.#.#.###
#.........#.#.#.#...###...#...#...#...#...#.#.#.#.#...#.#.#...#...#.#.#.#.###...#.....#.......#...#...#...###.#.#.....#...#.#...#...#...#...#
###########.#.#.###.###.#########.#.###.###.#.#.#.###.#.#.###.#.###.#.#.#.#####.#.###########.###.#.#####.###.#.#####.#.###.#.###.#########.#
#.........#.#.#...#...#.......#...#.#...###.#.#.#.#...#.#.#...#...#.#.#.#...>.>.#.....###...#...#.#.....#.#...#.#...#.#...#.#...#.#.......#.#
#.#######.#.#.###.###.#######.#.###.#.#####.#.#.#.#.###.#.#.#####.#.#.#.#####v#######.###.#.###.#.#####.#.#.###.#.#.#.###.#.###.#.#.#####.#.#
#.....###...#.#...###...#...#.#.#...#...#...#.#.#.#...#...#.#...#...#...###...#.......#...#.....#...#...#...#...#.#.#.#...#.#...#.#.#...#...#
#####.#######.#.#######.#.#.#.#.#.#####.#.###.#.#.###.#####.#.#.###########.###.#######.###########.#.#######.###.#.#.#.###.#.###.#.#.#.#####
#...#.......#.#.#.......#.#.#.#.#...#...#...#...#.#...#.....#.#...#...#...#...#.###...#.....#.......#...#...#.#...#.#.#...#.#...#.#...#.....#
#.#.#######.#.#.#.#######.#.#.#.###.#.#####.#####.#.###.#####.###.#.#.#.#.###.#.###.#.#####.#.#########.#.#.#.#.###.#.###.#.###.#.#########.#
#.#.........#...#...#...#.#.#.#.#...#.>.>.#.....#.#...#.......###...#.#.#.....#...#.#.#...#.#.........#...#.#...#...#...#.#.#...#.#.........#
#.#################.#.#.#.#.#.#.#.#####v#.#####.#.###.###############.#.#########.#.#.#.#.#.#########.#####.#####.#####.#.#.#.###.#.#########
#.................#...#.#.#.#.#.#.#.....#.#.....#.#...#.....#.........#...#...#...#.#.#.#.#.....#.....###...#...#.......#.#.#.....#.....#...#
#################.#####.#.#.#.#.#.#.#####.#.#####.#.###.###.#.###########.#.#.#.###.#.#.#.#####.#.#######.###.#.#########.#.###########.#.#.#
#.................###...#.#.#.#.#.#.....#.#.....#.#.###...#...#.....#...#.#.#.#...#.#.#.#.#...#.#...#.>.>.###.#...###...#...#...###...#...#.#
#.###################.###.#.#.#.#.#####.#.#####.#.#.#####.#####.###.#.#.#.#.#.###.#.#.#.#.#.#.#.###.#.#v#####.###.###.#.#####.#.###.#.#####.#
#...................#.#...#.#.#.#.#.....#.......#...#####.#.....###.#.#.#...#.###...#.#.#.#.#.#...#...#.....#.#...#...#.....#.#.....#.......#
###################.#.#.###.#.#.#.#.#####################.#.#######.#.#.#####.#######.#.#.#.#.###.#########.#.#.###.#######.#.###############
#.........#...#...#.#.#...#.#.#...#.........#.....#.......#.#.......#.#.#...#.......#...#...#...#.###.......#.#...#.......#.#.......###.....#
#.#######.#.#.#.#.#.#.###.#.#.#############.#.###.#.#######.#.#######.#.#.#.#######.###########.#.###.#######.###.#######.#.#######.###.###.#
#.....###...#...#.#.#.#...#.#.#.............#.#...#.........#.......#.#...#.#.......#.....#...#...#...#...###...#...#...#.#.###...#.....#...#
#####.###########.#.#.#.###.#.#.#############.#.###################.#.#####.#.#######.###.#.#.#####.###.#.#####.###.#.#.#.#.###.#.#######.###
#.....#...#...###...#...###...#...............#.....#...#...###...#.#.#.....#...#...#.#...#.#.....#.....#.....#.#...#.#.#.#.###.#.#...#...###
#.#####.#.#.#.#####################################.#.#.#.#.###.#.#v#.#.#######.#.#.#.#.###.#####.###########.#.#.###.#.#.#.###.#.#v#.#.#####
#.#...#.#.#.#...#...#...#.....#.......#.....#.......#.#.#.#.#...#.>.>.#.#...###...#...#.#...#.....#...###.....#.#...#.#.#.#.#...#.>.#.#.....#
#.#.#.#.#.#.###.#.#.#.#.#.###.#.#####.#.###.#.#######.#.#.#.#.#####v###.#.#.###########v#.###.#####.#.###.#####.###.#.#.#.#.#.#####v#.#####.#
#.#.#.#.#...#...#.#.#.#.#...#.#.....#...###...#...#...#.#.#...#.....###.#.#.#...#.....>.>.#...#...#.#.#...###...#...#.#.#.#.#.#####.#.......#
#.#.#v#.#####.###.#.#.#.###.#.#####.###########.#.#.###.#.#####.#######.#.#.#.#.#.#####v###.###.#.#.#.#.#####.###.###.#.#.#.#.#####.#########
#...#.>.#.....#...#.#.#.#...#...#...#.........#.#.#.###.#.#...#.......#...#.#.#.#.###...###...#.#.#.#.#...#...###.....#...#.#.#.....#.......#
#####v###.#####.###.#.#.#.#####.#.###.#######.#.#.#.###.#.#.#.#######.#####.#.#.#.###.#######.#.#.#.#.###v#.###############.#.#.#####.#####.#
#.....###.###...#...#.#...#.....#.....#.......#.#.#...#.#.#.#...#...#.....#...#...#...#####...#.#.#.#.#.>.>.#...#...#...###...#.#...#.#.....#
#.#######.###.###.###.#####.###########.#######.#.###.#.#.#.###.#.#.#####.#########.#######.###.#.#.#.#.#v###.#.#.#.#.#.#######.#.#.#.#.#####
#...#...#.#...#...###.....#...#.....#...#...#...#.....#...#...#...#.......#.......#.......#...#.#.#.#.#.#.#...#...#...#.......#...#.#.#.#...#
###.#.#.#.#.###.#########.###.#.###.#.###.#.#.###############.#############.#####.#######.###.#.#.#.#.#.#.#.#################.#####.#.#.#.#.#
###...#.#.#.###...###...#.#...#...#.#...#.#.#...........#####.........#.....#...#.#...#...#...#.#.#.#.#.#.#.#.....#...........#.....#.#...#.#
#######.#.#.#####.###.#.#.#.#####.#.###v#.#.###########.#############.#.#####.#.#.#.#.#.###.###.#.#.#.#.#.#.#.###.#.###########.#####.#####.#
#.......#...#.....#...#...#...#...#.#.>.>.#.....#.......#.............#.....#.#.#...#.#...#...#.#.#.#...#...#...#.#...#...#...#.....#...#...#
#.###########.#####.#########.#.###.#.#v#######.#.#######.#################.#.#.#####.###.###.#.#.#.###########.#.###.#.#.#.#.#####.###.#.###
#...#.......#.....#.....#.....#...#.#.#.......#.#.......#.............#.....#.#.....#...#.###...#...#...........#...#...#.#.#.......#...#...#
###.#.#####.#####.#####.#.#######.#.#.#######.#.#######.#############.#.#####.#####.###.#.###########.#############.#####.#.#########.#####.#
###...#.....#.....#...#.#...#.....#...#...#...#.........#...#...#...#.#.......#...#...#...#...#.....#.....#...#####.#.....#.....#...#.#.....#
#######.#####.#####.#.#.###.#.#########.#.#.#############.#.#.#.#.#.#.#########.#.###.#####.#.#.###.#####.#.#.#####.#.#########.#.#.#.#.#####
#.......#...#.......#.#...#...#...###...#...#...#.........#...#...#...#...#.....#.....#...#.#.#...#.#...#...#.....#...###...###...#.#.#.....#
#.#######.#.#########.###.#####.#.###.#######.#.#.#####################.#.#.###########.#.#.#.###.#.#.#.#########.#######.#.#######.#.#####.#
#.........#.#...#...#...#.#...#.#.#...#.......#.#.#...#.......#.....###.#.#.......#...#.#.#.#.###.#...#.#.........#...#...#.....#...#.#.....#
###########.#.#.#.#.###.#.#.#.#.#.#.###.#######.#.#.#.#.#####.#.###.###.#.#######.#.#.#.#.#.#.###.#####.#.#########.#.#.#######.#.###.#.#####
#.........#...#.#.#...#...#.#...#.#.....#.....#.#...#...#.....#...#.###.#.#...#...#.#.#.#...#...#.....#.#.....#...#.#.#...#.....#.....#.....#
#.#######.#####.#.###.#####.#####.#######.###.#.#########.#######.#.###.#.#.#.#v###.#.#.#######.#####.#.#####.#.#.#.#.###.#.###############.#
#.......#.#.....#.#...#...#.....#.#...###...#...#...#...#.....#...#.#...#.#.#.>.>.#.#.#.#.......#...#.#.#...#.#.#...#.#...#.....#.......#...#
#######.#.#.#####.#.###.#.#####.#.#.#.#####v#####.#.#.#.#####.#.###.#.###.#.###v#.#.#.#.#.#######.#.#.#.#.#.#v#.#####.#.#######.#.#####.#.###
#.......#...###...#...#.#.#####.#...#.....>.>.#...#.#.#.#.....#...#...###...#...#.#.#.#.#.#.....#.#.#.#...#.>.>.#.....#...#.....#.....#...###
#.#############.#####.#.#.#####.###########v#.#.###.#.#.#.#######.###########.###.#.#.#.#.#.###.#.#.#.#######v###.#######.#.#########.#######
#.........#...#.#.....#.#.###...#.....#...#.#.#.#...#.#.#.......#.........###...#...#.#.#.#.#...#.#.#.#.......###...#...#.#...#...###.......#
#########.#.#.#.#.#####.#.###.###.###.#.#.#.#.#.#.###.#.#######.#########.#####.#####.#.#.#.#.###.#.#.#.###########.#.#.#.###.#.#.#########.#
###.......#.#.#.#.#...#.#.#...###...#...#...#...#.#...#.#...#...#...#.....#...#.....#.#.#.#.#.#...#...#...#...###...#.#.#.#...#.#...#...#...#
###.#######.#.#.#.#.#.#.#.#.#######.#############.#.###.#.#.#.###.#.#.#####.#.#####.#.#.#.#.#.#.#########.#.#.###.###.#.#.#.###.###.#.#.#.###
#...#...###.#.#.#.#.#.#.#.#...#.....#...........#.#.#...#.#.#.#...#.#...#...#.......#.#.#.#.#.#.#####.....#.#...#...#.#.#.#...#.#...#.#.#...#
#.###.#.###.#.#.#.#.#.#.#.###.#.#####.#########.#.#.#.###.#.#v#.###.###.#.###########.#.#.#.#.#.#####.#####.###.###.#.#.#.###.#.#.###.#.###.#
#...#.#.#...#.#.#.#.#.#.#.#...#...#...#...#.....#...#.....#.>.>.###.#...#...#...#...#...#.#.#.#.#.....#...#.###...#...#...#...#.#.#...#.#...#
###.#.#.#.###.#.#.#.#.#.#.#.#####.#.###.#.#.#################v#####.#.#####.#.#.#.#.#####.#.#.#.#.#####.#.#.#####.#########.###.#.#.###.#.###
#...#.#.#...#...#.#.#.#.#...###...#.#...#...#...#.....#.......#...#...#...#...#...#...###...#.#.#.....#.#...#.....###...###.#...#.#.#...#.###
#.###.#v###.#####.#.#.#.#######.###.#.#######.#.#.###.#.#######.#.#####.#.###########.#######.#.#####.#.#####.#######.#.###.#.###.#.#.###v###
#.....#.>...#...#...#.#.#.......#...#.......#.#...#...#.......#.#.#...#.#.#...........#...###...###...#.#...#.........#...#...###...#.#.>.###
#######v#####.#.#####.#.#.#######.#########.#.#####.#########.#.#.#.#.#.#.#.###########.#.#########.###.#.#.#############.###########.#.#v###
#.......#.....#.....#.#.#.#...#...#.........#.....#.....#.....#.#...#...#.#.........#...#.#.......#...#.#.#.........#...#...#####...#...#...#
#.#######.#########.#.#.#.#.#.#.###.#############.#####.#.#####.#########.#########.#.###.#.#####.###.#.#.#########.#.#.###.#####.#.#######.#
#.......#.#.........#...#...#.#.#...#...#.....###...#...#.....#.....#.....#.........#.#...#...#...###...#.....#...#...#.....#.....#...#.....#
#######.#.#.#################.#.#.###.#.#.###.#####.#.#######.#####.#.#####.#########.#.#####.#.#############.#.#.###########.#######.#.#####
###.....#.#.#...#...###.....#.#.#.....#...#...#...#.#.###.....#...#.#.....#.#.....#...#.#...#.#...#...###...#...#.......#...#.......#.#...###
###.#####.#.#.#.#.#.###.###.#.#.###########.###.#.#.#.###v#####.#.#.#####.#.#.###.#.###.#.#.#.###.#.#.###.#.###########.#.#.#######.#.###.###
#...#...#.#...#...#.....#...#...#...........#...#...#...>.>.###.#.#...#...#...#...#...#...#.#.#...#.#...#.#.#...........#.#.###.....#...#...#
#.###.#.#.###############.#######.###########.###########v#.###.#.###.#.#######v#####.#####.#.#.###.###.#.#.#.###########.#.###.#######.###.#
#...#.#.#.#...............#...###...#...#...#.....#.......#.....#.#...#.#.....>.>...#.#.....#.#.###...#.#.#.#.....#...#...#...#...#.....#...#
###.#.#.#.#.###############.#.#####.#.#.#.#.#####.#.#############.#.###.#.#####v###.#.#.#####.#.#####.#.#.#.#####v#.#.#.#####.###.#.#####.###
###...#...#.......###.....#.#...###...#...#.#.....#.........#.....#...#.#...###...#.#.#.#...#.#...#...#.#.#.#...>.>.#.#.#.....###.#.###...###
#################.###.###.#.###.###########.#.#############.#.#######.#.###.#####.#.#.#.#.#.#.###.#.###.#.#.#.###v###.#.#.#######.#.###v#####
#...#.......#.....#...#...#...#.#...###...#.#.....#.........#.......#.#.#...#.....#...#...#...###.#...#.#.#...###...#.#.#.....#...#...>.#...#
#.#.#.#####.#v#####.###.#####.#.#.#.###.#.#.#####.#.###############.#.#.#.###.###################.###.#.#.#########.#.#.#####.#.#######v#.#.#
#.#.#.....#.#.>.###...#.....#.#.#.#.#...#...#.....#.#...#.......#...#.#.#...#.................#...#...#...###.....#.#.#.....#...#.....#...#.#
#.#.#####.#.#v#.#####.#####.#.#.#.#.#.#######.#####.#.#.#.#####.#.###.#.###.#################.#.###.#########.###.#.#.#####.#####.###.#####.#
#.#.......#...#...###.#.....#.#.#.#.#...#...#.....#.#.#...###...#.....#.....#.................#.#...#.........###...#.#...#.....#...#...#...#
#.###############.###.#.#####.#.#.#.###.#.#.#####.#.#.#######.###############.#################.#.###.###############.#.#.#####.###.###.#.###
#.#.........#...#...#.#.#...#.#.#.#.###.#.#.#...#.#.#.#.......###...........#...#.............#.#...#.....#.........#...#...#...#...###...###
#.#.#######.#.#.###.#.#.#.#.#.#.#.#.###v#.#.#.#.#.#.#.#.#########.#########.###.#.###########.#.###.#####.#.#######.#######.#.###.###########
#.#.#.......#.#.###.#.#.#.#.#.#...#...>.>.#.#.#.#.#.#.#.....#...#.#.........#...#.#.........#.#...#.#.....#.#.....#...#.....#.###...........#
#.#.#.#######.#.###.#.#.#.#.#.#########v###.#.#.#.#.#.#####.#.#.#.#.#########.###.#.#######.#.###.#.#.#####.#.###.###.#.#####.#############.#
#.#.#.#.....#.#...#.#.#...#...#.........###.#.#...#...#.....#.#...#...#.....#.....#...#...#...###...#.....#.#...#.#...#.......#.............#
#.#.#.#.###.#.###.#.#.#########.###########.#.#########.#####.#######.#.###.#########.#.#.###############.#.###.#.#.###########.#############
#.#.#...#...#.#...#...###...###.....#.....#.#.......#...#.....###.....#.#...#.......#...#...........#...#...#...#...#...###...#.............#
#.#.#####.###.#.#########.#.#######.#.###.#.#######.#.###.#######.#####.#.###.#####.###############.#.#.#####.#######.#.###.#.#############.#
#.#.....#.....#.....#...#.#...#...#...#...#...#.....#.#...#.......###...#...#.....#.................#.#.......###...#.#.###.#...#...........#
#.#####.###########.#.#.#.###.#.#.#####.#####.#.#####.#.###.#########.#####.#####.###################.###########.#.#.#.###.###.#.###########
#...#...#...........#.#.#.#...#.#.#...#.....#...#...#...###...........#.....#...#.........#...#.....#.........###.#...#...#.#...#...........#
###.#.###.###########.#.#.#.###.#.#.#.#####v#####.#.###################.#####.#.#########.#.#.#.###.#########.###.#######.#.#.#############.#
###...###.........#...#...#.#...#.#.#.#...>.>.###.#.###...###...#.......#...#.#.#...#.....#.#.#.#...#.......#...#.....#...#.#.#####.......#.#
#################v#.#######.#.###.#.#.#.###v#.###.#.###.#.###.#.#.#######.#.#.#.#.#.#.#####.#.#.#.###.#####.###.#####.#.###.#.#####v#####.#.#
###...#.........#.>.#.......#...#...#...###.#.....#...#.#.#...#...#...###.#.#.#.#.#.#.###...#...#...#...#...#...#.....#.#...#...#.>.#####...#
###.#.#.#######.#v###.#########.###########.#########.#.#.#.#######.#.###.#.#.#.#.#.#v###.#########.###.#.###.###.#####.#.#####.#.#v#########
#...#.#.......#...###.......#...###...#...#...#.......#.#.#.......#.#.#...#.#.#.#.#.>.>.#.....#.....#...#.#...###...###...#...#...#.........#
#.###.#######.#############.#.#####.#.#.#.###.#.#######.#.#######v#.#.#.###.#.#.#.###v#.#####.#.#####.###.#.#######.#######.#.#############.#
#...#...#...#...........###...###...#...#.....#.#...#...#.#.....>.>.#.#...#...#.#.#...#...###.#.#...#...#.#...#...#...#...#.#.###...#...#...#
###.###.#.#.###########.#########.#############.#.#.#.###.#.#####v###.###.#####.#.#.#####.###.#.#.#.###.#.###v#.#.###.#.#.#.#.###.#.#.#.#.###
###...#.#.#...........#.....#...#.............#.#.#.#...#...###...###.#...###...#.#.....#.....#.#.#...#.#.#.>.>.#.#...#.#...#.....#...#...###
#####.#.#.###########.#####.#.#.#############.#.#.#.###.#######.#####.#.#####.###.#####.#######.#.###.#.#.#.#v###.#.###.#####################
#.....#.#...........#...#...#.#.#.........#...#...#.#...###...#.....#.#.#...#.....###...###.....#...#.#.#...#.#...#.###.#...#.....#.........#
#.#####.###########.###.#.###.#.#.#######.#.#######.#.#####.#.#####.#.#.#.#.#########.#####.#######.#.#.#####.#.###.###.#.#.#.###.#.#######.#
#.....#...........#...#.#.###.#.#.#.....#.#...#...#...###...#.#.....#.#...#.#.........###...#...#...#.#.#.....#.....###...#...#...#...#.....#
#####.###########.###.#.#.###.#.#.#.###.#.###.#.#.#######.###.#.#####.#####.#.###########.###.#.#.###.#.#.#####################.#####.#.#####
#.....#.....#...#.....#.#.#...#...#.#...#.....#.#.#...#...###.#.....#.....#.#...........#...#.#.#.###.#.#.#.....#...#####...###.......#.....#
#.#####.###.#.#.#######.#.#.#######.#.#########.#.#.#.#.#####.#####.#####.#.###########.###.#.#.#.###.#.#.#.###.#.#.#####.#.###############.#
#.....#.###...#.......#...#...#.....#.......#...#.#.#.#.....#.#...#.....#.#.#.......#...###...#.#...#...#...#...#.#...#...#.#.......#...#...#
#####.#.#############.#######.#.###########.#.###.#.#.#####.#.#.#.#####.#.#.#.#####.#.#########.###.#########.###.###.#.###.#.#####.#.#.#.###
#.....#.#.............###...#.#.#.....#.....#...#...#.......#.#.#.#...#.#...#.....#.#.......#...#...#...#.....###.#...#...#...#...#...#...###
#.#####.#.###############.#.#.#.#.###.#.#######.#############.#.#.#.#.#.#########.#.#######.#.###.###.#.#.#######.#.#####.#####.#.###########
#.....#.#.............#...#.#...#...#...#...#...#.....#...###...#...#...#.....#...#.........#.....#...#...#.......#.....#.......#...........#
#####.#.#############.#.###.#######.#####.#.#.###.###.#.#.###############.###.#.###################.#######.###########.###################.#
#.....#.#...#.........#.#...#.....#.#...#.#.#.....###...#.........#.....#...#.#...................#.........#...#...#...###...#...#...#...#.#
#.#####.#.#.#.#########.#.###.###.#.#.#.#.#.#####################.#.###.###.#.###################.###########.#.#.#.#.#####.#.#.#.#.#.#.#.#.#
#.#.....#.#.#...#...###.#...#...#.#.#.#...#.#...#.....#...........#...#.#...#...#...#.............#...........#.#.#.#.#.....#...#.#.#...#...#
#.#.#####.#.###.#.#.###.###.###.#.#.#.#####.#.#.#.###.#.#############.#.#.#####.#.#.#.#############.###########.#.#.#.#.#########.#.#########
#.#.#.....#.....#.#.#...#...###.#.#...#.....#.#.#.#...#.....#...#####.#.#.....#...#.#.......#.....#.......#...#...#...#.......#...#.#.......#
#.#.#.###########.#.#.###.#####.#.#####.#####.#.#.#.#######.#.#.#####.#.#####.#####.#######.#.###.#######.#.#.###############.#.###.#.#####.#
#.#.#.............#.#...#...#...#...#...#.....#.#.#.#...#...#.#...#...#.#.....#...#.........#.#...#...###...#.#...#...........#.....#.....#.#
#.#.###############.###.###.#.#####.#.###.#####.#.#.#.#.#v###.###.#.###.#.#####.#.###########.#.###.#.#######.#.#.#.#####################.#.#
#...#####...........###.#...#...#...#...#.....#.#.#.#.#.>.>.#.#...#...#.#.......#.......#.....#...#.#.#...#...#.#.#.............#.....#...#.#
#########.#############.#.#####.#.#####v#####.#.#.#.#.#####.#.#.#####.#.###############.#.#######.#.#.#.#.#.###.#.#############.#.###.#.###.#
###...#...#.....###...#.#.#...#.#.#...>.>.#...#.#.#...#####...#.#.....#...#.....#...#...#.#.......#.#.#.#.#...#.#...#...#.......#.#...#...#.#
###.#.#.###.###.###.#.#.#.#.#.#.#.#.#####.#.###.#.#############.#.#######.#.###.#.#.#.###.#.#######.#.#.#.###.#.###.#.#.#.#######.#.#####.#.#
#...#...#...###...#.#.#.#.#.#.#.#...#.....#...#.#.....#.........#.#.......#...#.#.#...###.#.###...#.#.#.#.###.#.#...#.#.#...#...#.#...#...#.#
#.#######.#######.#.#.#.#.#.#.#.#####.#######.#.#####.#.#########.#.#########.#.#.#######.#.###.#.#.#.#.#.###v#.#.###.#.###v#.#.#.###.#.###.#
#.....#...#...###.#.#.#.#...#.#...###.#...#...#.#.....#.....#...#.#.###...###.#.#.....#...#...#.#.#.#.#.#.#.>.>.#...#.#.#.>.#.#...#...#.#...#
#####.#.###.#.###.#.#.#.#####.###.###.#.#.#.###.#.#########.#.#.#.#.###.#.###.#.#####v#.#####.#.#.#.#.#.#.#.#######.#.#.#.#v#.#####.###.#.###
#.....#.#...#.....#.#.#.....#...#.#...#.#.#...#.#.#.........#.#.#.#.#...#.#...#...#.>.>.#.....#.#.#.#.#.#.#.#.......#.#.#.#.#.#.....###.#.###
#.#####.#.#########.#.#####.###.#.#.###.#.###.#.#.#.#########.#.#.#.#.###.#.#####.#.#####.#####.#.#.#.#.#.#.#.#######.#.#.#.#.#.#######.#.###
#.......#...........#.......###...#.....#.....#...#...........#...#...###...#####...#####.......#...#...#...#.........#...#...#.........#...#
###########################################################################################################################################.#`

const SAMPLE_INPUT = `#.#####################
#.......#########...###
#######.#########.#.###
###.....#.>.>.###.#.###
###v#####.#v#.###.#.###
###.>...#.#.#.....#...#
###v###.#.#.#########.#
###...#.#.#.......#...#
#####.#.#.#######.#.###
#.....#.#.#.......#...#
#.#####.#.#.#########v#
#.#...#...#...###...>.#
#.#.#v#######v###.###v#
#...#.>.#...>.>.#.###.#
#####v#.#.###v#.#.###.#
#.....#...#...#.#.#...#
#.#########.###.#.#.###
#...###...#...#...#.###
###.###.#.###v#####v###
#...#...#.#.>.>.#.>.###
#.###.###.#.###.#.#v###
#.....###...###...#...#
#####################.#`

const sumIt = (prev: number, item: number) => prev + item

const useTestInput = false
const input = useTestInput ? SAMPLE_INPUT : REAL_INPUT

const grid = input.split('\n').map((line) => line.split(''))
const height = grid.length
console.log(grid)
const part1 = 'tbd'
// TODO build graph

let visited: string[] = []
class Vertex {
  /** grid x */
  x: number
  /** grid y */
  y: number
  /** distance from last branch */
  d: number
  kind: 'BRANCH' | 'REGULAR' | 'INCOMING'
  constructor(x: number, y: number, d: number) {
    this.x = x
    this.y = y
    this.d = d
    const incomingBranches =
      grid?.[this.y - 1]?.[this.x] === 'v' && grid[this.y][this.x - 1] === '>'
    if (incomingBranches) {
      this.kind = 'INCOMING'
    } else {
      this.kind = 'REGULAR'
    }
  }
  visit() {
    visited.push(`${this.x},${this.y}`)
  }
  findAdjacent(): Vertex[] {
    let ret: Vertex[] = []
    // Look North
    const visitedN = visited.includes(`${this.x},${this.y - 1}`)
    const branchN = this.y > 0 && grid[this.y - 1][this.x] === '.'
    const canGoNorth = branchN && !visitedN
    // Look East
    const visitedE = visited.includes(`${this.x + 1},${this.y}`)
    const branchE =
      grid[this.y][this.x + 1] === '.' || grid[this.y][this.x + 1] === '>'
    const canGoEast = branchE && !visitedE
    // Look South
    const visitedS = visited.includes(`${this.x},${this.y + 1}`)
    const branchS =
      this.y < height - 1 &&
      (grid[this.y + 1][this.x] === '.' || grid[this.y + 1][this.x] === 'v')
    const canGoSouth = branchS && !visitedS
    // Look West
    const visitedW = visited.includes(`${this.x - 1},${this.y}`)
    const branchW = grid[this.y][this.x - 1] === '.'
    const canGoWest = branchW && !visitedW

    const canBranch =
      grid[this.y][this.x + 1] === '>' && grid[this.y + 1][this.x] === 'v'

    if (canBranch && this.kind !== 'INCOMING') {
      this.kind = 'BRANCH'
    }

    let newD = this.d + 1

    if (canGoNorth) {
      ret.push(new Vertex(this.x, this.y - 1, newD))
    }
    if (canGoEast) {
      ret.push(new Vertex(this.x + 1, this.y, newD))
    }
    if (canGoSouth) {
      ret.push(new Vertex(this.x, this.y + 1, newD))
    }
    if (canGoWest) {
      ret.push(new Vertex(this.x - 1, this.y, newD))
    }
    return ret
  }
}

const start = new Vertex(1, 0, 0)
const addVertex = (vertex: Vertex, soFar: Vertex[]): void => {
  soFar.push(vertex)
  vertex.findAdjacent().forEach((newVertex) => {
    if (newVertex.kind === 'INCOMING') {
      const prevE = soFar.find(
        (v) => v.x === newVertex.x - 1 && v.y === newVertex.y
      )
      const prevN = soFar.find(
        (v) => v.x === newVertex.x && v.y === newVertex.y - 1
      )
      if (prevE && prevN) {
        const maxD = Math.max(prevE.d, prevN.d) + 1
        newVertex.d = maxD
        newVertex.visit()
        addVertex(newVertex, soFar)
      }
    } else {
      newVertex.visit()
      addVertex(newVertex, soFar)
    }
  })
}
let points: Vertex[] = []
addVertex(start, points)
let toDisplay: Vertex[] = []
toDisplay = points
console.log(points[points.length - 1])

const part2 = input
  .split('\n')
  .map((line) => {
    // console.log(line)
    return 1
  })
  .reduce(sumIt, 0)
// console.log(part2)

const size = 6
const CoDeO = () => {
  return (
    <main>
      <div style={{ display: 'flex' }}>
        <div>
          <h2>Day 23</h2>
          <p>Part 1: calculated is {part1}, and answer is 2010.</p>
          <p>Part 2: calculated is {part2}, and answer is TBD.</p>
          <p>
            <Link href="/advent-of-code-2023">Back to Advent</Link>
          </p>
        </div>
        <div>
          <div
            style={{
              margin: 20,
              position: 'relative',
            }}
          >
            {toDisplay.map((vertex, i) => (
              <div
                key={i}
                style={{
                  background:
                    vertex.kind === 'BRANCH'
                      ? '#f00'
                      : vertex.kind === 'INCOMING'
                        ? '#0f0'
                        : '#fff',
                  top: vertex.y * size,
                  left: vertex.x * size,
                  width: size,
                  height: size,
                  position: 'absolute',
                }}
              />
            ))}
          </div>
        </div>
      </div>
    </main>
  )
}

export default CoDeO
